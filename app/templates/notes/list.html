{% extends "base.html" %}
{% block content %}

<div class="container rr-page">
 <div class="rr-header">
   <h1 class="rr-h1">Rassemblements Ã  venir</h1>
   <a class="rr-add" href="{{ url_for('notes.create_note') }}">+ Ajouter un Ã©vÃ©nement</a>
 </div>

 {% if notes and notes|length > 0 %}
   <div class="rr-grid">
     {% for note in notes %}
       {% set cat = (note.category or "voiture")|lower %}
       <article class="rr-card category-{{ cat }}">
         <div class="rr-card-overlay"></div>

         <div class="rr-card-body">
           <div class="rr-badge">{{ cat|capitalize }}</div>

           <h3 class="rr-title">{{ note.title }}</h3>

           <p class="rr-desc">
             {{ (note.content or "")[:140] }}{% if note.content and note.content|length > 140 %}â€¦{% endif %}
           </p>

           <div class="rr-meta">
             <span>ðŸ•’ {{ note.created_at.strftime("%d/%m/%Y") if note.created_at else "" }}</span>
           </div>

           <div class="rr-actions">
             <a class="rr-btn rr-btn-edit" href="{{ url_for('notes.edit_note', note_id=note.id) }}">Modifier</a>

             <!-- IMPORTANT: suppression en POST -->
             <form class="rr-delete-form" method="POST" action="{{ url_for('notes.delete_note', note_id=note.id) }}">
               <button class="rr-btn rr-btn-del" type="submit" onclick="return confirm('Supprimer cet Ã©vÃ©nement ?');">
                 Supprimer
               </button>
             </form>
           </div>
         </div>
       </article>
     {% endfor %}
   </div>
 {% else %}
   <div class="rr-empty">
     <h2>Aucun Ã©vÃ©nement pour lâ€™instant</h2>
     <p>CrÃ©e ton premier rassemblement.</p>
     <a class="rr-add" href="{{ url_for('notes.create_note') }}">+ Ajouter un Ã©vÃ©nement</a>
   </div>
 {% endif %}
</div>

{% endblock %}